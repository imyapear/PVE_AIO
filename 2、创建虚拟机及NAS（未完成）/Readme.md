## 创建虚拟机

## 通过ISO安装NAS系统，适用于TrueNAS，OMV
1. 上传安装镜像；
- TrueNAS官网：https://www.truenas.com/
- OMV官网：https://www.openmediavault.org/
2. 创建虚拟机；
3. 安装系统；

## 通过U盘启动NAS系统，适用于unRAID
1. 制作unRAID启动盘
- unRAID官网：https://unraid.net/
2. 创建虚拟机（直通启动U盘）
3. 启动系统；

## 通过img镜像启动NAS系统，适用于DSM
跳转至教程：

### 硬盘直通方法

#### 方法一、RDM硬盘直通
##### 适用场景
优势：无需硬件直通，对个别硬盘的直通相对灵活；不使用硬件直通，可以使用虚拟机动态内存；

弱势：性能比直通控制器的直通方式碎片文件性能略弱（不会弱太多）；由于依然需要通过虚拟控制器，CPU资源稍高。

##### 设置方法
```
#查询硬盘识别码

ls -la /dev/disk/by-id/|grep -v dm|grep -v lvm|grep -v part
```

```
#将硬盘绑定到虚拟机上，将x替换为序号及硬盘识别码

qm set <vmid> --scsi[x] /dev/disk/by-id/[xxxxxxx]
```

#### 方法二、控制器直通或直通NVME硬盘
##### 适用场景
优势：整体磁盘性能接近物理机，性能损耗较少；

弱势：由于需要把整个控制器直通给虚拟机，无法针对个别硬盘做出设置，对于系统盘为sata接口，并接在需要直通控制器的场景不适用。

##### 设置方法

```
#查询磁盘控制器（或NVME硬盘）的硬件编号

lspci
```

设置直通控制器PCI硬件，具体操作方法参考视频。

#### 方法三、VirtIO-Scsi块状虚拟硬盘（区别于文件型虚拟硬盘）【不推荐】
##### 适用场景
优势：可以划扣硬盘里的一部分空间作为虚拟硬盘使用，性能与直通硬盘接近；

弱势：无法查看硬盘SMART信息，硬盘格式须为逻辑卷或ZFS之类的特定格式。必须通过虚拟机系统，才能将硬盘镜像挂载到虚拟机使用。

《暂缺》
